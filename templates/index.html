<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/css/styles.css">
    <title>Tongue-Controlled Fighting Game</title>
    <style>
        /* Motion detection overlay styles */
        .motion-overlay {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 300px;
            height: 200px;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #00ff00;
            border-radius: 10px;
            color: white;
            padding: 10px;
            font-family: Arial, sans-serif;
            z-index: 1000;
        }

        .motion-status {
            margin: 5px 0;
            font-size: 14px;
        }

        .motion-video {
            width: 100%;
            height: 120px;
            background: #333;
            border-radius: 5px;
            margin-top: 10px;
        }

        .calibration-controls {
            position: fixed;
            top: 240px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 10px;
            border: 2px solid #ffaa00;
        }

        .calibration-controls button {
            margin: 2px;
            padding: 5px 10px;
            background: #ffaa00;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }

        .calibration-controls button:hover {
            background: #ff8800;
        }

        /* Hide original player 2 instructions */
        .keys:nth-child(2) {
            display: none;
        }

        /* Update instructions for motion control */
        .motion-instructions {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #00aaff;
        }
    </style>
</head>

<body>
    <!-- Motion Detection Overlay -->
    <div class="motion-overlay">
        <div class="motion-status" id="headPoseStatus">Head Pose: Detecting...</div>
        <div class="motion-status" id="tongueStatus">Tongue: Detecting...</div>
        <div class="motion-status" id="gameAction">Action: None</div>
        <canvas class="motion-video" id="motionCanvas"></canvas>
    </div>

    <!-- Calibration Controls -->
    <div class="calibration-controls">
        <div>Sensitivity:</div>
        <button onclick="adjustSensitivity('decrease')">-</button>
        <span id="sensitivityLevel">Medium</span>
        <button onclick="adjustSensitivity('increase')">+</button>
        <br>
        <button onclick="calibrateMotion()">Recalibrate</button>
        <button onclick="toggleFallbackKeys()">Keyboard Fallback</button>
    </div>

    <div class="container">
        <!-- Menu (Player vs AI only) -->
        <div id="menu" class="menu">
            <div class="title; animate-charcter">
                Tongue Fighting Game!
            </div>
            <div class="options">
                <div id="1player" class="menuOption">
                    Player vs AI (Tongue Control)
                </div>
            </div>
            <div class="author">Made with Tongue Detection</div>
        </div>

        <!-- HUD -->
        <div id="hud" class="hud">
            <!-- Player's health -->
            <div class="healthLayout">
                <div class="remainingHealthbar"></div>
                <div id="playerHealth" class="totalHealthBar"></div>
            </div>
            <!-- Timer -->
            <div id="timer" class="timer"> -- </div>

            <!-- Enemy's health -->
            <div class="healthLayout">
                <div class="remainingHealthbar"></div>
                <div id="enemyHealth" class="totalHealthBar"></div>
            </div>
        </div>

        <div id="result" class="result"> result </div>
        <div class="game">
            <canvas id="gameWindow"> </canvas>
        </div>
    </div>

    <!-- Motion Control Instructions -->
    <div class="motion-instructions">
        <h3>üéÆ Motion Controls:</h3>
        <p>üëÖ <strong>Tongue Left/Right:</strong> Move character</p>
        <p>üëÖ <strong>Tongue Up:</strong> Jump</p>
        <p>üó£Ô∏è <strong>Head Tilt Left:</strong> Attack 1</p>
        <p>üó£Ô∏è <strong>Head Tilt Right:</strong> Attack 2</p>
        <p>üìπ <strong>Position yourself in front of camera for best detection</strong></p>
    </div>

    <!-- Hidden video element for motion detection -->
    <video id="motionVideo" style="display: none;" autoplay muted></video>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.10.4/gsap.min.js"
        integrity="sha512-VEBjfxWUOyzl0bAwh4gdLEaQyDYPvLrZql3pw1ifgb6fhEvZl9iDDehwHZ+dsMzA0Jfww8Xt7COSZuJ/slxc4Q=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!-- MediaPipe for motion detection -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js"></script>

    <!-- Motion Detection Script -->
    <script src="/static/js/motion-detection.js"></script>

    <!-- Modified Game Scripts -->
    <script type="module" src="/static/js/index.js"></script>
</body>
</html>